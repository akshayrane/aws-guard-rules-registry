[
    {
      "name": "Rule is not run when ElasticSearch domain is not present",
      "input": {},
      "expectations": {
        "rules": {
          "elasticsearch_encrypted_at_rest": "SKIP"
        }
      }
    },
    {
      "name": "Rule passes when ElasticSearch domain has server side encryption property is set to true",
      "input": {
        "Resources": {
          "ElasticsearchDomain": {
            "Type": "AWS::Elasticsearch::Domain",
            "Properties": {
              "DomainName": "test",
              "EncryptionAtRestOptions": {
                "Enabled": true
              }
            }
          }
        }
      },
      "expectations": {
        "rules": {
          "elasticsearch_encrypted_at_rest": "PASS"
        }
      }
    },
    {
      "name": "Rule fails when ElasticSearch domain has server side encryption property is set to false",
      "input": {
        "Resources": {
          "ElasticsearchDomain": {
            "Type": "AWS::Elasticsearch::Domain",
            "Properties": {
              "DomainName": "test",
              "EncryptionAtRestOptions": {
                "Enabled": false
              }
            }
          }
        }
      },
      "expectations": {
        "rules": {
          "elasticsearch_encrypted_at_rest": "FAIL"
        }
      }
    },
    {
      "name": "Rule fails when ElasticSearch domain has server side encryption property missing",
      "input": {
        "Resources": {
          "ElasticsearchDomain": {
            "Type": "AWS::Elasticsearch::Domain",
            "Properties": {
              "DomainName": "test"
            }
          }
        }
      },
      "expectations": {
        "rules": {
          "elasticsearch_encrypted_at_rest": "FAIL"
        }
      }
    }
  ]